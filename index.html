<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>ZÜMRA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:Arial,sans-serif;
}

/* === YAĞMUR === */
canvas{
  position:fixed;
  inset:0;
  z-index:1;
}

/* === ZÜMRA === */
#center{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:3;
  pointer-events:none;
}
#title{
  font-size:clamp(70px,14vw,170px);
  letter-spacing:14px;
  color:#000;
  -webkit-text-stroke:1px #fff;
}
#title span{
  color:#ff2a2a;
  margin-left:20px;
  text-shadow:0 0 15px rgba(255,40,40,.8);
}

/* === ISLAK DAMLA === */
#wets{
  position:fixed;
  inset:0;
  z-index:2;
  pointer-events:none;
}
.drop{
  position:absolute;
  top:-50px;
  width:18px;
  height:18px;
  border-radius:50%;
  background:radial-gradient(circle at 30% 30%,
    rgba(255,255,255,.9),
    rgba(255,255,255,.2),
    rgba(255,255,255,0));
  animation:drip linear forwards;
}
@keyframes drip{
  to{
    transform:translateY(120vh) scale(1.4);
    opacity:0;
  }
}

/* === ŞARKI SEÇ === */
#pickWrap{
  position:fixed;
  bottom:40px;
  width:100%;
  text-align:center;
  z-index:5;
}
button{
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.3);
  color:white;
  padding:14px 22px;
  border-radius:12px;
  font-size:16px;
}
input[type=file]{display:none}

/* === DİKEY PANEL === */
#panel{
  position:fixed;
  right:20px;
  top:50%;
  transform:translateY(-50%);
  width:60px;
  height:260px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.25);
  border-radius:16px;
  display:none;
  flex-direction:column;
  align-items:center;
  justify-content:space-evenly;
  z-index:6;
}
#panel label{
  writing-mode:vertical-rl;
  color:#aaa;
  font-size:12px;
}
input[type=range]{
  appearance:none;
  width:160px;
  height:4px;
  transform:rotate(-90deg);
  background:#666;
  border-radius:5px;
}
input[type=range]::-webkit-slider-thumb{
  appearance:none;
  width:14px;
  height:14px;
  background:white;
  border-radius:50%;
}
</style>
</head>

<body>

<canvas id="rain"></canvas>
<div id="wets"></div>

<div id="center">
  <div id="title">ZÜMRA <span>♥</span></div>
</div>

<div id="panel">
  <label>SES</label>
  <input type="range" id="volume" min="0" max="1" step="0.01">
  <label>SÜRE</label>
  <input type="range" id="seek" min="0" max="100" step="0.1">
</div>

<div id="pickWrap">
  <button id="pickBtn">Şarkı Seç</button>
  <input type="file" id="file" accept="audio/*">
</div>

<audio id="audio" loop></audio>

<script>
/* === YAĞMUR === */
const c=document.getElementById("rain");
const ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();addEventListener("resize",resize);

const rain=[];
for(let i=0;i<1000;i++){
  rain.push({
    x:Math.random()*c.width,
    y:Math.random()*c.height,
    l:10+Math.random()*25,
    s:10+Math.random()*15,
    w:Math.random()*1.2-.6,
    o:Math.random()*.5+.2
  });
}
function draw(){
  ctx.fillStyle="rgba(0,0,0,.25)";
  ctx.fillRect(0,0,c.width,c.height);
  rain.forEach(r=>{
    ctx.beginPath();
    ctx.strokeStyle=`rgba(255,255,255,${r.o})`;
    ctx.moveTo(r.x,r.y);
    ctx.lineTo(r.x-r.w*2,r.y-r.l);
    ctx.stroke();
    r.x+=r.w;r.y+=r.s;
    if(r.y>c.height)r.y=-50;
  });
  requestAnimationFrame(draw);
}
draw();

/* === ISLAK DAMLA === */
setInterval(()=>{
  if(Math.random()<0.25){
    const d=document.createElement("div");
    d.className="drop";
    d.style.left=Math.random()*innerWidth+"px";
    d.style.animationDuration=8+Math.random()*6+"s";
    wets.appendChild(d);
    setTimeout(()=>d.remove(),15000);
  }
},3000);

/* === MÜZİK === */
const audio=document.getElementById("audio");
const file=document.getElementById("file");
const pickBtn=document.getElementById("pickBtn");
const pickWrap=document.getElementById("pickWrap");
const panel=document.getElementById("panel");
const volume=document.getElementById("volume");
const seek=document.getElementById("seek");

volume.value=0.7;
audio.volume=0.7;

const req=indexedDB.open("ZUMRA_DB",1);
let db;

req.onupgradeneeded=e=>{
  db=e.target.result;
  db.createObjectStore("music");
};
req.onsuccess=e=>{
  db=e.target.result;
  const tx=db.transaction("music","readonly")
    .objectStore("music").get("song");
  tx.onsuccess=()=>{
    if(tx.result){
      audio.src=tx.result;
      audio.play();
      pickWrap.style.display="none";
      panel.style.display="flex";
    }
  };
};

pickBtn.onclick=()=>file.click();

file.onchange=()=>{
  const f=file.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=()=>{
    db.transaction("music","readwrite")
      .objectStore("music").put(r.result,"song");
    audio.src=r.result;
    audio.play();
    pickWrap.style.display="none";
    panel.style.display="flex";
  };
  r.readAsDataURL(f);
};

volume.oninput=()=>audio.volume=volume.value;
audio.ontimeupdate=()=>{
  if(audio.duration){
    seek.max=audio.duration;
    seek.value=audio.currentTime;
  }
};
seek.oninput=()=>audio.currentTime=seek.value;
</script>

</body>
</html>
